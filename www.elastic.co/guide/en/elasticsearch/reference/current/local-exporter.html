<html><!-- Mirrored from www.elastic.co/guide/en/elasticsearch/reference/current/local-exporter.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 01 Apr 2020 14:19:15 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->

    
<meta charset="UTF-8">
<title>Local exporters </title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.6]">
<link rel="up" href="es-monitoring-exporters.html" title="Exporters">
<link rel="prev" href="es-monitoring-exporters.html" title="Exporters">
<link rel="next" href="http-exporter.html" title="HTTP exporters">
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.6">
<meta name="DC.subject" content="Elasticsearch">
<meta name="DC.identifier" content="7.6">

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="../../../../../apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../../../../../apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../../../../apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../../../../../apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../../../../apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../../../../../apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../../../../../apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../../../../../apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="../../../../../favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../../../android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="../../../../../favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="../../../../../favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="../../../../../manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="../../../../../mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd">
    <meta name="yandex-verification" content="d8a47e95d0972434">
    <meta name="localized" content="true">
    <meta name="st:robots" content="follow,index">
    <meta property="og:image" content="../../../../../static/images/elastic-logo-200.png">
    <link rel="shortcut icon" href="../../../../../favicon.ico" type="image/x-icon">
    <link rel="icon" href="../../../../../favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="../../../../../favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="../../../../../favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="../../../../../favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="../../../../static/styles.css">
  </head>

  <body>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="./gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type="text/javascript">
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id="ZN_emkP0oSe9Qrn7kF"><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id="elastic-nav" style="display:none;"></div>
    <script src="../../../../../elastic-nav.js"></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="https://www.elastic.co/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content">
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.6]</a></span>
»
<span class="breadcrumb-link"><a href="monitor-elasticsearch-cluster.html">Monitor a cluster</a></span>
»
<span class="breadcrumb-link"><a href="es-monitoring-exporters.html">Exporters</a></span>
»
<span class="breadcrumb-node">Local exporters</span>
</div>
<div class="navheader">
<span class="prev">
<a href="es-monitoring-exporters.html">« Exporters</a>
</span>
<span class="next">
<a href="http-exporter.html">HTTP exporters »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a class="dashAnchor" name="//dash_ref_4650/Section/Sections/1"></a><a class="dashAnchor" name="//dash_ref_4651/Section/Local%20exporters/0"></a><a id="local-exporter"></a>Local exporters<a class="xpack_tag" href="https://www.elastic.co/subscriptions"></a></h2>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Metricbeat is the recommended method for collecting and shipping monitoring
data to a monitoring cluster.</p>
<p>If you have previously configured internal collection, you should migrate to
using Metricbeat collection. Use either Metricbeat collection or
internal collection; do not use both.</p>
<p>Learn more about <a class="xref" href="configuring-metricbeat.html" title="Collecting Elasticsearch monitoring data with Metricbeat"><em>Collecting monitoring data with Metricbeat</em></a>.</p>
</div>
</div>
<p>The <code class="literal">local</code> exporter is the default exporter in X-Pack monitoring. It routes data
back into the same (local) cluster. In other words, it uses the production
cluster as the monitoring cluster. For example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.monitoring.exporters.my_local_exporter: <a id="CO449-1"></a><i class="conum" data-value="1"></i>
  type: local</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tbody><tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO449-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The exporter name uniquely defines the exporter, but it is otherwise unused.</p>
</td>
</tr>
</tbody></table>
</div>
<p>This exporter exists to provide a convenient option when hardware is simply not
available. It is also a way for developers to get an idea of what their actions
do for pre-production clusters when they do not have the time or resources to
provide a separate monitoring cluster. However, this exporter has disadvantages
that impact the local cluster:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
All indexing impacts the local cluster and the nodes that hold the monitoring
indices' shards.
</li>
<li class="listitem">
Most collectors run on the elected master node. Therefore most indexing occurs
with the elected master node as the coordinating node, which is a bad practice.
</li>
<li class="listitem">
Any usage of X-Pack monitoring for Kibana uses the local cluster’s resources for
searches and aggregations, which means that they might not be available for
non-monitoring tasks.
</li>
<li class="listitem">
If the local cluster goes down, the monitoring cluster has inherently gone
down with it (and vice versa), which generally defeats the purpose of monitoring.
</li>
</ul>
</div>
<p>For the <code class="literal">local</code> exporter, all setup occurs only on the elected master node. This
means that if you do not see any monitoring templates or ingest pipelines, the
elected master node is having issues or it is not configured in the same way.
Unlike the <code class="literal">http</code> exporter, the <code class="literal">local</code> exporter has the advantage of accessing
the monitoring cluster’s up-to-date cluster state. It can therefore always check
that the templates and ingest pipelines exist without a performance penalty. If
the elected master node encounters errors while trying to create the monitoring
resources, it logs errors, ignores that collection, and tries again after the
next collection.</p>
<p>The elected master node is the only node to set up resources for the <code class="literal">local</code>
exporter. Therefore all other nodes wait for the resources to be set up before
indexing any monitoring data from their own collectors. Each of these nodes logs
a message indicating that they are waiting for the resources to be set up.</p>
<p>One benefit of the <code class="literal">local</code> exporter is that it lives within the cluster and
therefore no extra configuration is required when the cluster is secured with
Elastic Stack security features. All operations, including indexing operations, that
occur from a <code class="literal">local</code> exporter make use of the internal transport mechanisms
within Elasticsearch. This behavior enables the exporter to be used without providing any
user credentials when security features are enabled.</p>
<p>For more information about the configuration options for the <code class="literal">local</code> exporter,
see <a class="xref" href="monitoring-settings.html#local-exporter-settings" title="Local Exporter Settings">Local Exporter Settings</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a class="dashAnchor" name="//dash_ref_4649/Section/Cleaner%20service/0"></a><a id="local-exporter-cleaner"></a>Cleaner service</h3>
</div></div></div>
<p>One feature of the <code class="literal">local</code> exporter, which is not present in the <code class="literal">http</code> exporter,
is a cleaner service. The cleaner service runs once per day at 01:00 AM UTC on
the elected master node.</p>
<p>The role of the cleaner service is to clean, or curate, the monitoring indices
that are older than a configurable amount of time (the default is <code class="literal">7d</code>). This
cleaner exists as part of the <code class="literal">local</code> exporter as a safety mechanism. The <code class="literal">http</code>
exporter does not make use of it because it could enable a single misconfigured
node to prematurely curate data from other production clusters that share the
same monitoring cluster.</p>
<p>In a dedicated monitoring cluster, the cleaning service can be used without
having to also monitor the monitoring cluster. For example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.monitoring.collection.enabled: false <a id="CO450-1"></a><i class="conum" data-value="1"></i>
xpack.monitoring.history.duration: 3d <a id="CO450-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tbody><tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO450-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Disable the collection of data on the monitoring cluster.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO450-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Lower the default history duration from <code class="literal">7d</code> to <code class="literal">3d</code>. The minimum value is
<code class="literal">1d</code>. This setting can be modified only when using a Gold or higher level
license. For the Basic license level, it uses the default of 7 days.</p>
</td>
</tr>
</tbody></table>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="es-monitoring-exporters.html">« Exporters</a>
</span>
<span class="next">
<a href="http-exporter.html">HTTP exporters »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/cloud/elasticsearch-service/signup?baymax=default&amp;elektra=docs&amp;storm=top-video">Elasticsearch Service: Free Trial</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&amp;elektra=docs&amp;storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&amp;elektra=docs&amp;storm=top-video">ELK for Logs &amp; Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id="elastic-footer"></div>
<script src="../../../../../elastic-footer.js"></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"https://www.elastic.co/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="../../../../../static/js/swiftype_app_search.umd.min.js"></script>
<script src="../../../../static/jquery.js"></script>
<script type="text/javascript" src="../../../../static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  

<!-- Mirrored from www.elastic.co/guide/en/elasticsearch/reference/current/local-exporter.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 01 Apr 2020 14:19:15 GMT -->

<script type="text/javascript" src="https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF"></script><script type="text/javascript" src="https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF"></script></body></html>